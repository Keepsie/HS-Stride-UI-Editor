<Window x:Class="HS.Stride.UI.Editor.Views.ColorPickerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Color Picker"
        Height="520"
        Width="580"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Style="{StaticResource ModernWindow}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/ModernTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border Background="{StaticResource MediumBackgroundBrush}" Padding="20">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Left: Color Picker Area -->
            <StackPanel Grid.Column="0" Margin="0,0,16,0">
                <!-- Saturation/Brightness Square -->
                <TextBlock Text="Color"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           FontSize="11"
                           Margin="0,0,0,4"/>
                <Border BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <Canvas x:Name="ColorSquare"
                            Width="256"
                            Height="256"
                            ClipToBounds="True"
                            MouseDown="ColorSquare_MouseDown"
                            MouseMove="ColorSquare_MouseMove"
                            MouseUp="ColorSquare_MouseUp">
                        <!-- Base color (changes with hue) -->
                        <Rectangle x:Name="ColorSquareBase"
                                   Width="256"
                                   Height="256"
                                   Fill="Red"/>
                        <!-- White to transparent gradient (left to right) -->
                        <Rectangle Width="256" Height="256">
                            <Rectangle.Fill>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="White" Offset="0"/>
                                    <GradientStop Color="Transparent" Offset="1"/>
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <!-- Black to transparent gradient (top to bottom) -->
                        <Rectangle Width="256" Height="256">
                            <Rectangle.Fill>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="Transparent" Offset="0"/>
                                    <GradientStop Color="Black" Offset="1"/>
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <!-- Selection circle -->
                        <Ellipse x:Name="ColorSelector"
                                 Width="14"
                                 Height="14"
                                 Stroke="White"
                                 StrokeThickness="2"
                                 IsHitTestVisible="False">
                            <Ellipse.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="3" ShadowDepth="0" Opacity="0.5"/>
                            </Ellipse.Effect>
                        </Ellipse>
                    </Canvas>
                </Border>

                <!-- Hue Bar -->
                <TextBlock Text="Hue"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           FontSize="11"
                           Margin="0,12,0,4"/>
                <Border BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <Canvas x:Name="HueBar"
                            Width="256"
                            Height="20"
                            ClipToBounds="True"
                            MouseDown="HueBar_MouseDown"
                            MouseMove="HueBar_MouseMove"
                            MouseUp="HueBar_MouseUp">
                        <Canvas.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FFFF0000" Offset="0.000"/>
                                <GradientStop Color="#FFFFFF00" Offset="0.167"/>
                                <GradientStop Color="#FF00FF00" Offset="0.333"/>
                                <GradientStop Color="#FF00FFFF" Offset="0.500"/>
                                <GradientStop Color="#FF0000FF" Offset="0.667"/>
                                <GradientStop Color="#FFFF00FF" Offset="0.833"/>
                                <GradientStop Color="#FFFF0000" Offset="1.000"/>
                            </LinearGradientBrush>
                        </Canvas.Background>
                        <!-- Hue selector -->
                        <Rectangle x:Name="HueSelector"
                                   Width="4"
                                   Height="20"
                                   Fill="White"
                                   IsHitTestVisible="False">
                            <Rectangle.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="3" ShadowDepth="0" Opacity="0.5"/>
                            </Rectangle.Effect>
                        </Rectangle>
                    </Canvas>
                </Border>

                <!-- Alpha Bar -->
                <TextBlock Text="Alpha"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           FontSize="11"
                           Margin="0,12,0,4"/>
                <Border BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <Canvas x:Name="AlphaBar"
                            Width="256"
                            Height="20"
                            ClipToBounds="True"
                            MouseDown="AlphaBar_MouseDown"
                            MouseMove="AlphaBar_MouseMove"
                            MouseUp="AlphaBar_MouseUp">
                        <!-- Checkered background for alpha -->
                        <Canvas.Background>
                            <DrawingBrush TileMode="Tile" Viewport="0,0,10,10" ViewportUnits="Absolute">
                                <DrawingBrush.Drawing>
                                    <DrawingGroup>
                                        <GeometryDrawing Brush="#CCCCCC">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry Rect="0,0,10,10"/>
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FFFFFF">
                                            <GeometryDrawing.Geometry>
                                                <GeometryGroup>
                                                    <RectangleGeometry Rect="0,0,5,5"/>
                                                    <RectangleGeometry Rect="5,5,5,5"/>
                                                </GeometryGroup>
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                    </DrawingGroup>
                                </DrawingBrush.Drawing>
                            </DrawingBrush>
                        </Canvas.Background>
                        <!-- Alpha gradient overlay -->
                        <Rectangle x:Name="AlphaGradient" Width="256" Height="20">
                            <Rectangle.Fill>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="Transparent" Offset="0"/>
                                    <GradientStop Color="Red" Offset="1"/>
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <!-- Alpha selector -->
                        <Rectangle x:Name="AlphaSelector"
                                   Width="4"
                                   Height="20"
                                   Fill="White"
                                   IsHitTestVisible="False">
                            <Rectangle.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="3" ShadowDepth="0" Opacity="0.5"/>
                            </Rectangle.Effect>
                        </Rectangle>
                    </Canvas>
                </Border>
            </StackPanel>

            <!-- Right: Values and Preview -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Color Preview -->
                <StackPanel Grid.Row="0" Margin="0,0,0,16">
                    <TextBlock Text="Preview"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="11"
                               Margin="0,0,0,4"/>
                    <Border Height="60"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="4">
                        <Border.Background>
                            <DrawingBrush TileMode="Tile" Viewport="0,0,12,12" ViewportUnits="Absolute">
                                <DrawingBrush.Drawing>
                                    <DrawingGroup>
                                        <GeometryDrawing Brush="#CCCCCC">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry Rect="0,0,12,12"/>
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FFFFFF">
                                            <GeometryDrawing.Geometry>
                                                <GeometryGroup>
                                                    <RectangleGeometry Rect="0,0,6,6"/>
                                                    <RectangleGeometry Rect="6,6,6,6"/>
                                                </GeometryGroup>
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                    </DrawingGroup>
                                </DrawingBrush.Drawing>
                            </DrawingBrush>
                        </Border.Background>
                        <Rectangle x:Name="ColorPreview" Fill="Red" RadiusX="3" RadiusY="3"/>
                    </Border>
                </StackPanel>

                <!-- Hex Input -->
                <StackPanel Grid.Row="1" Margin="0,0,0,16">
                    <TextBlock Text="Hex Code"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="11"
                               Margin="0,0,0,4"/>
                    <TextBox x:Name="HexText"
                             Style="{StaticResource ModernTextBox}"
                             Padding="10,8"
                             FontSize="14"
                             FontFamily="Consolas"
                             MaxLength="9"
                             TextChanged="HexText_TextChanged"/>
                </StackPanel>

                <!-- RGBA Values -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Red -->
                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,4,8">
                        <TextBlock Text="R"
                                   Foreground="#FFEF4444"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="RedText"
                                 Style="{StaticResource ModernTextBox}"
                                 Padding="8,6"
                                 FontSize="13"
                                 TextAlignment="Center"
                                 MaxLength="3"
                                 TextChanged="RGBA_TextChanged"/>
                    </StackPanel>

                    <!-- Green -->
                    <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,0,0,8">
                        <TextBlock Text="G"
                                   Foreground="#FF22C55E"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="GreenText"
                                 Style="{StaticResource ModernTextBox}"
                                 Padding="8,6"
                                 FontSize="13"
                                 TextAlignment="Center"
                                 MaxLength="3"
                                 TextChanged="RGBA_TextChanged"/>
                    </StackPanel>

                    <!-- Blue -->
                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,4,0">
                        <TextBlock Text="B"
                                   Foreground="#FF3B82F6"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="BlueText"
                                 Style="{StaticResource ModernTextBox}"
                                 Padding="8,6"
                                 FontSize="13"
                                 TextAlignment="Center"
                                 MaxLength="3"
                                 TextChanged="RGBA_TextChanged"/>
                    </StackPanel>

                    <!-- Alpha -->
                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="4,0,0,0">
                        <TextBlock Text="A"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="AlphaText"
                                 Style="{StaticResource ModernTextBox}"
                                 Padding="8,6"
                                 FontSize="13"
                                 TextAlignment="Center"
                                 MaxLength="3"
                                 TextChanged="RGBA_TextChanged"/>
                    </StackPanel>
                </Grid>
            </Grid>

            <!-- Buttons -->
            <Grid Grid.Row="1" Grid.ColumnSpan="2" Margin="0,16,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Transparent button on the left -->
                <Button Grid.Column="0"
                        Style="{StaticResource ModernButton}"
                        Background="{StaticResource InputBackgroundBrush}"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="1"
                        Padding="12,10"
                        Click="TransparentButton_Click"
                        ToolTip="Set color to fully transparent">
                    <StackPanel Orientation="Horizontal">
                        <Grid Width="16" Height="16" Margin="0,0,6,0">
                            <!-- Checkered pattern to indicate transparency -->
                            <Rectangle Fill="#808080" RadiusX="2" RadiusY="2"/>
                            <Rectangle Fill="#C0C0C0" Width="8" Height="8" HorizontalAlignment="Left" VerticalAlignment="Top" RadiusX="2" RadiusY="2"/>
                            <Rectangle Fill="#C0C0C0" Width="8" Height="8" HorizontalAlignment="Right" VerticalAlignment="Bottom" RadiusX="2" RadiusY="2"/>
                        </Grid>
                        <TextBlock Text="Transparent" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Grid.Column="2"
                        Content="OK"
                        Style="{StaticResource PrimaryButton}"
                        Width="100"
                        Margin="0,0,8,0"
                        Click="OkButton_Click"
                        IsDefault="True"/>

                <Button Grid.Column="3"
                        Content="Cancel"
                        Style="{StaticResource ModernButton}"
                        Background="{StaticResource InputBackgroundBrush}"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="1"
                        Padding="16,10"
                        Width="100"
                        Click="CancelButton_Click"
                        IsCancel="True"/>
            </Grid>
        </Grid>
    </Border>
</Window>
